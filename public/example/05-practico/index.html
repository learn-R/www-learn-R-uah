<!DOCTYPE html>
<html lang="en-us" 
      xmlns:og="http://ogp.me/ns#" 
      xmlns:fb="https://www.facebook.com/2008/fbml">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.2.0 for Hugo" />
  

  

  
  
  
  
  
  

  

  
  
  
    
  
  <meta name="description" content="0. Objetivo del práctico El objetivo del presente práctico es aprender a manipular datos, en particular, agrupar datos según alguna(s) columna(s) o filas en particular, pivotando sets de datos, y uniendo y/o separando datos." />

  
  <link rel="alternate" hreflang="en-us" href="/example/05-practico/" />

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    <meta name="theme-color" content="#5271FF" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">

    
    

    
    
    
      
    
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans+Condensed:400,400i,700,700i%7CBarlow:ital,wght@0,400;0,700;1,400;1,700&display=swap">
      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.563f345701788434b4fee407179620aa.css" />

  



  

  

  




  
  
  

  

  
    <link rel="manifest" href="/index.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_2.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_180x180_fill_lanczos_center_2.png" />

  <link rel="canonical" href="/example/05-practico/" />

  
  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary" />
  
    <meta property="twitter:site" content="@valentiandrade" />
    <meta property="twitter:creator" content="@valentiandrade" />
  
  <meta property="og:site_name" content="Análisis Estadístico en R" />
  <meta property="og:url" content="/example/05-practico/" />
  <meta property="og:title" content="Tidydata y manipulación de datos | Análisis Estadístico en R" />
  <meta property="og:description" content="0. Objetivo del práctico El objetivo del presente práctico es aprender a manipular datos, en particular, agrupar datos según alguna(s) columna(s) o filas en particular, pivotando sets de datos, y uniendo y/o separando datos." /><meta property="og:image" content="/media/logo_hu02bc8dfe7cae86b2ee03430b67caeaf2_22353_300x300_fit_lanczos_2.png" />
    <meta property="twitter:image" content="/media/logo_hu02bc8dfe7cae86b2ee03430b67caeaf2_22353_300x300_fit_lanczos_2.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2021-08-13T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2021-08-13T00:00:00&#43;00:00">
  

  



  

  

  <link rel="stylesheet" type="text/css" href="/custom-css/print.css" media="print" />

  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/img/apple-touch-icon-152x152.png" />
  <link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16" />
  <meta name="application-name" content="2255: Análisis Estadístico en R" />
  <meta name="msapplication-TileColor" content="#FFFFFF" />
  <meta name="msapplication-TileImage" content="/img/mstile-144x144.png" />


  <title>Tidydata y manipulación de datos | Análisis Estadístico en R</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  <script src="/js/wowchemy-init.js"></script>

    




    











  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/media/logo_hu02bc8dfe7cae86b2ee03430b67caeaf2_22353_0x70_resize_lanczos_2.png" alt="Análisis Estadístico en R"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/media/logo_hu02bc8dfe7cae86b2ee03430b67caeaf2_22353_0x70_resize_lanczos_2.png" alt="Análisis Estadístico en R"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Organización</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/schedule/"><span>Planificación</span></a>
            
              <a class="dropdown-item" href="/syllabus/"><span>Syllabus</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/content/"><span>Clases</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/example/"><span>Prácticos</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Tareas <i class="fab fa-github"></i></span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/assignment/"><span>Tareas</span></a>
            
              <a class="dropdown-item" href="https://classroom.github.com/classrooms/86887318-learn-r-uah-2021"><span>Github Classroom<i class="fab fa-github"></i></span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/resource/"><span>Recursos</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="https://join.slack.com/t/learn-r-uah/shared_invite/zt-sh9uysuu-IzEG8~u5k2YYGWgpAFTRFA" target="_blank" rel="noopener"><span><i class="fab fa-slack"></i></span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="https://rstudio.cloud/" target="_blank" rel="noopener"><span><i class="fab fa-r-project"></i></span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      

      
      

      
      

      
      

    </ul>

  </div>
</nav>



    

<div class="container-fluid docs">
    <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
            





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
    
  

  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/example/">Información general</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/example/">Prácticos (códigos de ejemplo)</a>
      </li>

      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" >Datos</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/example/01-practico/">Ejemplos</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/example/01-practico/">1: R, RStudio y Github</a>
      </li>

      
      <li >
        <a href="/example/02-practico/">2: RMarkdown</a>
      </li>

      
      <li >
        <a href="/example/03-practico/">3: Importar, explorar y limpiar datos</a>
      </li>

      
      <li >
        <a href="/example/04-practico/">4: Transformar y seleccionar variables</a>
      </li>

      
      <li >
        <a href="/example/08-practico/">8: Regresiones lineales, predictores categóricos y representación gráfica</a>
      </li>

      
      <li class="active">
        <a href="/example/05-practico/">5: Tidydata y manipulación de datos</a>
      </li>

      
      <li >
        <a href="/example/06-practico/">6: Análisis descriptivo</a>
      </li>

      
      <li >
        <a href="/example/07-practico/">7: Muestras complejas y precisión de inferencia estadística</a>
      </li>

      
      <li >
        <a href="/example/09-practico/">09: Regresión logística</a>
      </li>

      
      <li >
        <a href="/example/10-practico/">10: Calidad de modelos y otras técnicas de estimación</a>
      </li>

      
    </ul>
    

  </div>
  
  
</nav>

        </div>

        
        <div class="d-none d-xl-block col-xl-2 docs-toc">
            <ul class="nav toc-top">
                <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
            </ul>

            <nav id="TableOfContents">
  <ul>
    <li><a href="#0-objetivo-del-práctico">0. Objetivo del práctico</a></li>
    <li><a href="#1-recursos-de-la-práctica">1. Recursos de la práctica</a></li>
    <li><a href="#2-librerías-a-utilizar">2. Librerías a utilizar</a></li>
  </ul>

  <ul>
    <li><a href="#1-cargar-librerías">1. Cargar librerías</a></li>
    <li><a href="#2-importar-bases-de-datos">2. Importar bases de datos</a></li>
    <li><a href="#3-explorar-datos">3. Explorar datos</a></li>
    <li><a href="#4-agrupar-por-filas-con-rowwise">4. Agrupar por filas con <code>rowwise()</code></a></li>
    <li><a href="#5-agrupar-por-columnas-con-group_by">5. Agrupar por columnas con <code>group_by()</code></a></li>
    <li><a href="#6-manipulación-de-datos-tidydata">6. Manipulación de datos (tidydata)</a>
      <ul>
        <li><a href="#a-pivot_longer">a) <code>pivot_longer()</code></a></li>
        <li><a href="#b-pivot_wider">b) <code>pivot_wider</code></a></li>
      </ul>
    </li>
    <li><a href="#7-separate">7. <code>separate()</code></a></li>
    <li><a href="#8-unite">8. <code>unite()</code></a></li>
    <li><a href="#9-unir-datos">9. Unir datos</a>
      <ul>
        <li><a href="#a-merge">a) <code>merge</code></a></li>
        <li><a href="#b-bind_cols">b) <code>bind_cols()</code></a></li>
        <li><a href="#c-bind_rows">c) <code>bind_rows()</code></a></li>
      </ul>
    </li>
  </ul>
</nav>

 
        </div>
        

        <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

            <article class="article">

                <div class="docs-article-container">
                    <h1>Tidydata y manipulación de datos</h1>

                    

                    

                    

                    <div class="article-style">
                        <h2 id="0-objetivo-del-práctico">0. Objetivo del práctico</h2>
<p>El objetivo del presente práctico es aprender a manipular datos, en particular, agrupar datos según alguna(s) columna(s) o filas en particular,  pivotando sets de datos, y uniendo y/o separando datos.</p>
<h2 id="1-recursos-de-la-práctica">1. Recursos de la práctica</h2>
<p>Los datos a utilizar provienen de la <a href="https://www.ine.cl/estadisticas/sociales/ingresos-y-gastos/encuesta-suplementaria-de-ingresos" target="_blank" rel="noopener">Encuesta Suplementaria de Ingresos (ESI) en su versión 2020</a>, módulo de la Encuesta Nacional de Empleo (ENE), levantada una vez al año para caracterizar los ingresos laborales de quienes son clasificadas/os como ocupadas/os en la ENE, y otras fuentes de ingresos de los hogares. No olvides que, cuando trabajes con datos, debes revisar la <strong>documentación anexa</strong>, como el <a href="https://www.ine.cl/docs/default-source/encuesta-suplementaria-de-ingresos/bbdd/manual-y-gu%c3%ada-de-variables/2020/personas-esi-2020.pdf?sfvrsn=f196cb4e_4" target="_blank" rel="noopener"><strong>libro de códigos</strong></a>.</p>
<h2 id="2-librerías-a-utilizar">2. Librerías a utilizar</h2>
<p>En este práctico utilizaremos las siguientes librerías</p>
<ol>
<li>
<p><code>pacman</code>: este facilita y agiliza la lectura de los paquetes a utilizar en R</p>
</li>
<li>
<p><code>tidyverse</code>: colección de librerías, de la cual utilizaremos <code>tidyr</code>, <code>haven</code> y <code>dplyr</code></p>
</li>
<li>
<p><code>tidyr</code>: permite pivotear los set de datos con los cuales estamos trabajando</p>
</li>
<li>
<p><code>dplyr</code>: para manipular datos</p>
</li>
<li>
<p><code>sjmisc</code>: para explorar datos</p>
</li>
</ol>
<h1 id="procesamiento-de-datos">Procesamiento de datos</h1>
<h2 id="1-cargar-librerías">1. Cargar librerías</h2>
<p>Lo primero es <em>cargar las librerías</em> a utilizar. Para ello, acudimos a la función <code>p_load</code> del paquete <code>pacman</code>. Asumimos que ya está instalado, así que sólo lo cargaremos con la función <code>library()</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(pacman)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#960050;background-color:#1e0010">##</span> <span style="color:#a6e22e">Warning</span>: <span style="color:#f92672">package</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">pacman</span><span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#a6e22e">was</span> <span style="color:#a6e22e">built</span> <span style="color:#a6e22e">under</span> <span style="color:#a6e22e">R</span> <span style="color:#a6e22e">version</span> <span style="color:#ae81ff">4.0.5</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">pacman<span style="color:#f92672">::</span><span style="color:#a6e22e">p_load</span>(tidyverse, <span style="color:#75715e">#Universo de librerías para manipular datos</span>
               tidyr, <span style="color:#75715e">#Para pivotear la estructura de los datos</span>
               dplyr,<span style="color:#75715e">#Para manipular datos </span>
               sjmisc)<span style="color:#75715e">#Para explorar datos</span>
</code></pre></div><h2 id="2-importar-bases-de-datos">2. Importar bases de datos</h2>
<p>Cargaremos los datos</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">datos <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">readRDS</span>(<span style="color:#a6e22e">gzcon</span>(<span style="color:#a6e22e">url</span>(<span style="color:#e6db74">&#34;https://github.com/learn-R/05-class/blob/main/input/data/ESI2020.rds?raw=true&#34;</span>)))
</code></pre></div><p>En el panel <strong>Environment</strong>, visualizamos los nuevos objetos, que poseen 18.985 observaciones (o filas) y 9 variables (columnas).</p>
<h2 id="3-explorar-datos">3. Explorar datos</h2>
<p>A continuación, utilizaremos la función <code>View()</code> del paquete <code>base</code>, para revisar el set de datos.</p>
<p>Ocupamos, además, la función <code>frq()</code> de la librería <code>sjmisc</code>, para explorar las categorías de las variables de clase factor:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">frq</span>(datos<span style="color:#f92672">$</span>sector)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## 
## x &lt;categorical&gt;
## # total N=18985  valid N=18985  mean=1.12  sd=0.44
## 
## Value                    |     N | Raw % | Valid % | Cum. %
## -----------------------------------------------------------
## Sector formal            | 17576 | 92.58 |   92.58 |  92.58
## Sector informal          |   593 |  3.12 |    3.12 |  95.70
## Hogares como empleadores |   816 |  4.30 |    4.30 | 100.00
## &lt;NA&gt;                     |     0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">frq</span>(datos<span style="color:#f92672">$</span>sexo)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## 
## x &lt;categorical&gt;
## # total N=18985  valid N=18985  mean=1.43  sd=0.50
## 
## Value  |     N | Raw % | Valid % | Cum. %
## -----------------------------------------
## Hombre | 10810 | 56.94 |   56.94 |  56.94
## Mujer  |  8175 | 43.06 |   43.06 | 100.00
## &lt;NA&gt;   |     0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">frq</span>(datos<span style="color:#f92672">$</span>prevision)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## 
## x &lt;categorical&gt;
## # total N=18985  valid N=18985  mean=1.14  sd=0.34
## 
## Value |     N | Raw % | Valid % | Cum. %
## ----------------------------------------
## Si    | 16366 | 86.20 |   86.20 |  86.20
## No    |  2619 | 13.80 |   13.80 | 100.00
## &lt;NA&gt;  |     0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">frq</span>(datos<span style="color:#f92672">$</span>salud)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## 
## x &lt;categorical&gt;
## # total N=18985  valid N=18985  mean=1.12  sd=0.32
## 
## Value |     N | Raw % | Valid % | Cum. %
## ----------------------------------------
## Si    | 16761 | 88.29 |   88.29 |  88.29
## No    |  2224 | 11.71 |   11.71 | 100.00
## &lt;NA&gt;  |     0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">frq</span>(datos<span style="color:#f92672">$</span>contrato_dur)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## 
## x &lt;categorical&gt;
## # total N=18985  valid N=18985  mean=1.72  sd=0.45
## 
## Value      |     N | Raw % | Valid % | Cum. %
## ---------------------------------------------
## Definido   |  5263 | 27.72 |   27.72 |  27.72
## Indefinido | 13722 | 72.28 |   72.28 | 100.00
## &lt;NA&gt;       |     0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;
</code></pre></div><p>Podemos darnos cuenta de que la variable <code>sector</code> provee información sobre el <em>sector donde se encuentra ocupado/a el/la trabajador/a</em>; la variable <code>sexo</code> indica el <em>sexo de las y los trabajadores</em>; las columnas <code>prevision</code> y <code>salud</code> proveen información sobre <em>si el/la empleador/a paga cotizaciones relativas a los sistemas previsional y de salud</em> a las y los trabajadores; y la variable <code>contrato_dur</code> provee información sobre la <em>duración del contrato</em> de las y los trabajadores.</p>
<p>Ahora exploremos las variables numéricas con <code>descr()</code> de <code>sjmisc</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">descr</span>(datos<span style="color:#f92672">$</span>ss_t) <span style="color:#75715e">#Ingresos por sueldo y salarios netos</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## 
## ## Basic descriptive statistics
## 
##  var    type label     n NA.prc     mean       sd      se       md  trimmed
##   dd numeric    dd 18985      0 567520.6 585556.6 4249.75 400526.4 469716.4
##            range      iqr skew
##  9e+06 (0-9e+06) 401607.8 3.57
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">descr</span>(datos<span style="color:#f92672">$</span>svar_t) <span style="color:#75715e">#Ingresos por sueldos y salarios variables</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## 
## ## Basic descriptive statistics
## 
##  var    type label     n NA.prc     mean       sd     se md trimmed
##   dd numeric    dd 18985      0 13730.59 78880.74 572.49  0  816.25
##                      range iqr  skew
##  5006580.18 (0-5006580.18)   0 22.33
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">descr</span>(datos<span style="color:#f92672">$</span>reg_t) <span style="color:#75715e">#Total ingresos por regalías (beneficios entregados por el empleador)</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## 
## ## Basic descriptive statistics
## 
##  var    type label     n NA.prc    mean       sd     se md trimmed
##   dd numeric    dd 18985      0 8392.62 38868.17 282.09  0       0
##                      range iqr skew
##  1071408.16 (0-1071408.16)   0 9.44
</code></pre></div><p>Estas variables proveen información sobre <em>Ingresos por sueldo y salarios netos</em> (<code>ss_t</code>); <em>Ingresos por sueldos y salarios variables</em> (<code>svar_t</code>); y respecto a <em>Total ingresos por regalías (beneficios entregados por el empleador)</em> (<code>reg_t</code>).</p>
<h2 id="4-agrupar-por-filas-con-rowwise">4. Agrupar por filas con <code>rowwise()</code></h2>
<p>Como sabemos, la librería <code>dplyr</code> de <code>tidyverse</code> provee diversas herramientas que nos permiten manipular los datos con los cuales nos encontramos trabajando. Una de ellas es su función <code>rowwise()</code>, que posibilita <strong>agrupar los datos en razón de las filas</strong>. Esto es particularmente útil cuando, por ejemplo, queremos construir algún índice. En este caso, utilizaremos las diversas variables de ingresos para construir la variable <code>ing_tot</code>, que incluirá los ingresos totales percibidos por las y los trabajadores, en razón de sus sueldos y salarios netos; sus sueldos y salarios variables; y por las regalías entregadas por parte de las y los empleadores.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">datos <span style="color:#f92672">&lt;-</span> datos <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e">#Especificamos que trabajaremos con el dataframe datos</span>
  <span style="color:#a6e22e">rowwise</span>() <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e">#Especificamos que agruparemos por filas</span>
  <span style="color:#a6e22e">mutate</span>(ing_tot <span style="color:#f92672">=</span> <span style="color:#a6e22e">sum</span>(ss_t, svar_t, reg_t)) <span style="color:#75715e">#Creamos una nueva variable llamada ing_tot, sumando los valores de ss_t, svar_t y reg_t para cada fila </span>
<span style="color:#a6e22e">head</span>(datos)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## # A tibble: 6 x 10
## # Rowwise: 
##   sector   sexo  prevision salud contrato_dur   ss_t svar_t reg_t     id ing_tot
##   &lt;fct&gt;    &lt;fct&gt; &lt;fct&gt;     &lt;fct&gt; &lt;fct&gt;         &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1 Sector ~ Mujer Si        Si    Indefinido   3.20e5      0     0  20256 320421.
## 2 Sector ~ Mujer Si        Si    Definido     7.5 e5      0     0  24592 750000 
## 3 Sector ~ Mujer Si        Si    Indefinido   9   e5      0     0  35136 900000 
## 4 Hogares~ Mujer No        No    Indefinido   3.02e5      0     0 235953 302042.
## 5 Sector ~ Homb~ Si        Si    Indefinido   9   e5      0     0 251187 900000 
## 6 Sector ~ Homb~ Si        Si    Indefinido   0           0     0 318992      0
</code></pre></div><p>Como vemos, ahora el set de datos pasó de tener 8 a 10 variables (columnas). Sin embargo, la cantidad de filas se mantiene constante, con un total de 18.985.</p>
<p>Sin embargo, como ya no utilizaremos <code>ss_t</code>, <code>svar_t</code> ni <code>reg_t</code> por separado, las des-seleccionaremos con <code>select()</code> de <code>dplyr</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">datos <span style="color:#f92672">&lt;-</span> datos <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">select</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">c</span>(ss_t, svar_t, reg_t))
<span style="color:#a6e22e">head</span>(datos)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## # A tibble: 6 x 7
## # Rowwise: 
##   sector                   sexo   prevision salud contrato_dur     id ing_tot
##   &lt;fct&gt;                    &lt;fct&gt;  &lt;fct&gt;     &lt;fct&gt; &lt;fct&gt;         &lt;dbl&gt;   &lt;dbl&gt;
## 1 Sector formal            Mujer  Si        Si    Indefinido    20256 320421.
## 2 Sector formal            Mujer  Si        Si    Definido      24592 750000 
## 3 Sector formal            Mujer  Si        Si    Indefinido    35136 900000 
## 4 Hogares como empleadores Mujer  No        No    Indefinido   235953 302042.
## 5 Sector formal            Hombre Si        Si    Indefinido   251187 900000 
## 6 Sector formal            Hombre Si        Si    Indefinido   318992      0
</code></pre></div><h2 id="5-agrupar-por-columnas-con-group_by">5. Agrupar por columnas con <code>group_by()</code></h2>
<p>Otra de las funciones de <code>dplyr</code> que nos permiten manipular los datos es <code>group_by</code>. En este caso, en lugar de agrupar los valores por filas, podremos hacerlo en razón de las <strong>columnas</strong>. Calculemos ahora la media de <code>ing_tot</code> con la función <code>mean()</code>, agrupando por <code>sexo</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">datos <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">group_by</span>(sexo) <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e">#Espeficicamos que agruparemos por sexo</span>
  <span style="color:#a6e22e">summarise</span>(media <span style="color:#f92672">=</span> <span style="color:#a6e22e">mean</span>(ing_tot)) <span style="color:#75715e">#Creamos una columna llamada media, calculando la media ingresos con la función `mean`</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## # A tibble: 2 x 2
##   sexo     media
##   &lt;fct&gt;    &lt;dbl&gt;
## 1 Hombre 630757.
## 2 Mujer  535278.
</code></pre></div><p>Es importante destacar que la función <code>summarise()</code> (o <code>summarize()</code>) de <code>dplyr</code> nos permite crear un nuevo data frame con una o más filas para cada combinación y agrupación de variables. En este caso, tenemos dos filas: una para Hombre, y otra para Mujer. En caso de no agrupar variables, sólo tendremos una columna que <strong>resuma</strong> las observaciones especificadas.</p>
<p>Algo interesante es que podemos combinar <code>group_by()</code> con algunas funciones de <code>sjmisc</code>. Probemos calculando la frecuencia de hombres y mujeres agrupando por cada sector:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">datos <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">group_by</span>(sector) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">frq</span>(sexo)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## 
## sexo &lt;categorical&gt;
## # grouped by: Sector formal
## # total N=17576  valid N=17576  mean=1.42  sd=0.49
## 
## Value  |     N | Raw % | Valid % | Cum. %
## -----------------------------------------
## Hombre | 10212 | 58.10 |   58.10 |  58.10
## Mujer  |  7364 | 41.90 |   41.90 | 100.00
## &lt;NA&gt;   |     0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;
## 
## 
## sexo &lt;categorical&gt;
## # grouped by: Sector informal
## # total N=593  valid N=593  mean=1.17  sd=0.37
## 
## Value  |   N | Raw % | Valid % | Cum. %
## ---------------------------------------
## Hombre | 493 | 83.14 |   83.14 |  83.14
## Mujer  | 100 | 16.86 |   16.86 | 100.00
## &lt;NA&gt;   |   0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;
## 
## 
## sexo &lt;categorical&gt;
## # grouped by: Hogares como empleadores
## # total N=816  valid N=816  mean=1.87  sd=0.34
## 
## Value  |   N | Raw % | Valid % | Cum. %
## ---------------------------------------
## Hombre | 105 | 12.87 |   12.87 |  12.87
## Mujer  | 711 | 87.13 |   87.13 | 100.00
## &lt;NA&gt;   |   0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;
</code></pre></div><p>Obtendremos una tabla por cada una de las categorías de la variable por la cual agrupamos (en este caso, una por cada sector), que señala las frecuencias absolutas y relativas de cada sexo para cada sector. Por supuesto, también podemos hacer el mismo ejercicio con <code>descr()</code>. Probemos haciendo un análisis descriptivos de ingresos para cada sexo:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">datos <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">group_by</span>(sexo) <span style="color:#f92672">%&gt;%</span> 
  <span style="color:#a6e22e">descr</span>(ing_tot)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## 
## ## Basic descriptive statistics
## 
## 
## Grouped by: Hombre
## 
##      var    type   label     n NA.prc     mean       sd      se       md
##  ing_tot numeric ing_tot 10810      0 630757.4 665519.9 6401.01 448028.4
##   trimmed                     range    iqr skew
##  515273.1 9312239.14 (0-9312239.14) 419636 3.63
## 
## 
## Grouped by: Mujer
## 
##      var    type   label    n NA.prc     mean       sd      se    md  trimmed
##  ing_tot numeric ing_tot 8175      0 535278.2 512300.3 5666.05 4e+05 455651.4
##                      range      iqr skew
##  6208159.43 (0-6208159.43) 407377.7 3.12
</code></pre></div><p>En este caso, obtenemos dos tablas: una por cada <code>sexo</code>, cada una indicando las estadísticas de resumen para la variable <code>ing_tot</code></p>
<h2 id="6-manipulación-de-datos-tidydata">6. Manipulación de datos (tidydata)</h2>
<p>Otra de las librerías de <code>tidyverse</code> que resulta de gran utilidad es <code>tidyr</code>. En este caso, cada una de las filas de nuestros datos indican a un sujeto (el cual constituye la unidad de análisis). Las funciones <code>pivot_longer()</code> y <code>pivot_wider()</code> de la librería anteriormente señalada nos permitirán pivotear los datos, para transformarlos a un dataframe de formato <strong>long</strong> (largo) o <strong>wide</strong> (ancho), respectivamente.</p>
<h3 id="a-pivot_longer">a) <code>pivot_longer()</code></h3>
<p>Como ya se señaló, <code>pivot_longer()</code>nos permitirá pivotear los datos de manera tal que estos se transformen a un tabulado en formato <strong>long</strong>. Ello implica que el tabulado tendrá un mayor número de observaciones, reduciendo su cantidad de columnas. En este caso, pivotearemos todas las columnas salvo <code>sector</code>, lo cual significa que tales columnas se subsumirán en una sola (en este caso, llamada &ldquo;variable&rdquo;), y sus respectivos valores en otra (en este caso, llamada &ldquo;value&rdquo;). Luego, la unidad de análisis pasará, de ser sujetos, a ser las variables. Para ello usamos el siguiente código:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">long <span style="color:#f92672">&lt;-</span> datos <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e">#Creamos un nuevo objeto a partir de datos</span>
  <span style="color:#a6e22e">select</span>(<span style="color:#f92672">-</span>ing_tot) <span style="color:#f92672">%&gt;%</span>  <span style="color:#75715e">#Des-seleccionamos la variable ing_tot, pues es de class numeric</span>
  <span style="color:#a6e22e">pivot_longer</span>(cols<span style="color:#f92672">=-</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1</span>, id), <span style="color:#75715e">#Pivoteamos a lo largo todas las columnas salvo la primera (sector) </span>
               names_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;variable&#34;</span>, <span style="color:#75715e">#Especificamos que la columna &#34;variable&#34; incluirá los nombres de cada una de las columnas pivoteadas</span>
               values_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;value&#34;</span>) <span style="color:#75715e">#Especificamos que la columna &#34;value&#34; incluirá los valores de cada una de las columnas pivoteadas</span>
<span style="color:#a6e22e">head</span>(long)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## # A tibble: 6 x 4
##   sector           id variable     value     
##   &lt;fct&gt;         &lt;dbl&gt; &lt;chr&gt;        &lt;fct&gt;     
## 1 Sector formal 20256 sexo         Mujer     
## 2 Sector formal 20256 prevision    Si        
## 3 Sector formal 20256 salud        Si        
## 4 Sector formal 20256 contrato_dur Indefinido
## 5 Sector formal 24592 sexo         Mujer     
## 6 Sector formal 24592 prevision    Si
</code></pre></div><p>Podemos darnos cuenta de que ahora nuestro set de datos sólo contiene 4 columnas, pero 75.940 filas. Podemos darnos cuenta que ahora, cada cuatro columnas, tenemos a un sujeto de la muestra.</p>
<h3 id="b-pivot_wider">b) <code>pivot_wider</code></h3>
<p>Asimismo, las tablas largas (long) pueden ser transformadas a tablas anchas (wide) con la función <code>pivot_wider()</code>, lo cual implica que nuestra tabla reducirá su cantidad de filas y aumentará su número de columnas. Para ello, sólo debemos especificar desde dónde extraeremos los nombres y los valores asociados a las nuevas columnas:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">wide <span style="color:#f92672">&lt;-</span> long <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e">#Creamos un nuevo objeto a partir de los datos de long </span>
  <span style="color:#a6e22e">pivot_wider</span>(names_from <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;variable&#34;</span>, <span style="color:#75715e">#Pivoteamos, tomando el nombre de las columnas desde la columna &#34;variable&#34;</span>
              values_from <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;value&#34;</span>) 
<span style="color:#a6e22e">head</span>(wide)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## # A tibble: 6 x 6
##   sector                       id sexo   prevision salud contrato_dur
##   &lt;fct&gt;                     &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;     &lt;fct&gt; &lt;fct&gt;       
## 1 Sector formal             20256 Mujer  Si        Si    Indefinido  
## 2 Sector formal             24592 Mujer  Si        Si    Definido    
## 3 Sector formal             35136 Mujer  Si        Si    Indefinido  
## 4 Hogares como empleadores 235953 Mujer  No        No    Indefinido  
## 5 Sector formal            251187 Hombre Si        Si    Indefinido  
## 6 Sector formal            318992 Hombre Si        Si    Indefinido
</code></pre></div><p>Los datos se &ldquo;ensancharon&rdquo;, pasando a tener 18.985 filas y 6 columnas.</p>
<h2 id="7-separate">7. <code>separate()</code></h2>
<p>La función <code>separate()</code> de <code>tidyr</code> nos permite convertir un character individual de una columna en múltiples columnas. En este caso, crearemos una nueva variable <code>sobre_prom</code>, que nos indicará si los ingresos de los sujetos están por sobre o por debajo de la media de ingresos. Luego, separaremos la primera y la segunda palabra (caracteres) de cada unos de los valores en dos columnas distintas.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">separate <span style="color:#f92672">&lt;-</span> datos <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e">#Creamos un nuevo objeto desde datos</span>
  <span style="color:#a6e22e">mutate</span>(sobre_prom <span style="color:#f92672">=</span> <span style="color:#a6e22e">case_when</span>(ing_tot <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">mean</span>(ing_tot) <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;Bajo media&#34;</span>, 
                                ing_tot <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">mean</span>(ing_tot) <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;Sobre media&#34;</span>)) <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e">#Creamos una variable condicional con case_when(), para identificar quienes estan bajo y sobre la media de ingreso</span>
  <span style="color:#a6e22e">separate</span>(sobre_prom, <span style="color:#75715e">#Especificamos la columna que queremos separar</span>
           into <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;sobre_o_bajo&#34;</span>, <span style="color:#e6db74">&#34;media&#34;</span>)) <span style="color:#75715e">#Especificamos en cuántas columnas queremos separar los characteres, y cómo se llamarán tales columnas</span>
<span style="color:#a6e22e">head</span>(separate)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## # A tibble: 6 x 9
##   sector    sexo  prevision salud contrato_dur     id ing_tot sobre_o_bajo media
##   &lt;fct&gt;     &lt;fct&gt; &lt;fct&gt;     &lt;fct&gt; &lt;fct&gt;         &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;
## 1 Sector f~ Mujer Si        Si    Indefinido    20256 320421. Bajo         media
## 2 Sector f~ Mujer Si        Si    Definido      24592 750000  Bajo         media
## 3 Sector f~ Mujer Si        Si    Indefinido    35136 900000  Bajo         media
## 4 Hogares ~ Mujer No        No    Indefinido   235953 302042. Bajo         media
## 5 Sector f~ Homb~ Si        Si    Indefinido   251187 900000  Bajo         media
## 6 Sector f~ Homb~ Si        Si    Indefinido   318992      0  Bajo         media
</code></pre></div><h2 id="8-unite">8. <code>unite()</code></h2>
<p>También podemos unir caracteres de columnas distintas, con la función <code>unite()</code> de <code>tidyr</code>. En este caso, volveremos a unir las columnas ¿Sobre o bajo? y Media en una sola, llamada sobre_prom. Por defecto, <code>unite()</code> une los caracteres con guiones bajos (_). Podemos especificar un nuevo separador con el argumento <code>sep</code>. En este caso, el separador será un espacio (&quot; &ldquo;)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">separate <span style="color:#f92672">&lt;-</span> separate <span style="color:#f92672">%&gt;%</span> <span style="color:#75715e">#Modificamos el objeto separate</span>
  <span style="color:#a6e22e">unite</span>(col <span style="color:#f92672">=</span> sobre_media, <span style="color:#75715e">#Unimos en una nueva columna llamada sobre_media</span>
        sobre_o_bajo<span style="color:#f92672">:</span>media, <span style="color:#75715e">#Especificamos las columnas que deseamos unir</span>
        sep <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; &#34;</span>) <span style="color:#75715e">#Especificamos el separador</span>
<span style="color:#a6e22e">head</span>(separate)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## # A tibble: 6 x 8
##   sector           sexo  prevision salud contrato_dur     id ing_tot sobre_media
##   &lt;fct&gt;            &lt;fct&gt; &lt;fct&gt;     &lt;fct&gt; &lt;fct&gt;         &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      
## 1 Sector formal    Mujer Si        Si    Indefinido    20256 320421. Bajo media 
## 2 Sector formal    Mujer Si        Si    Definido      24592 750000  Bajo media 
## 3 Sector formal    Mujer Si        Si    Indefinido    35136 900000  Bajo media 
## 4 Hogares como em~ Mujer No        No    Indefinido   235953 302042. Bajo media 
## 5 Sector formal    Homb~ Si        Si    Indefinido   251187 900000  Bajo media 
## 6 Sector formal    Homb~ Si        Si    Indefinido   318992      0  Bajo media
</code></pre></div><h2 id="9-unir-datos">9. Unir datos</h2>
<p>Otra de las herramientas fundamentales a la hora de trabajar con la estructura de los datos es unir dos tabulados distintos con los cuales estemos trabajando.</p>
<h3 id="a-merge">a) <code>merge</code></h3>
<p>Una de las funciones más utilizadas para ello es <code>merge</code> del paquete <code>base</code> de R. Esta nos permite unir dos tabulados (data frames) que compartan una columna, y que tengan la misma cantidad de filas.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">esi2020_m <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">readRDS</span>(<span style="color:#a6e22e">gzcon</span>(<span style="color:#a6e22e">url</span>(<span style="color:#e6db74">&#34;https://github.com/learn-R/05-class/blob/main/input/data/ESI2020m.rds?raw=true&#34;</span>))) <span style="color:#75715e">#Cargamos los datos que deseamos unir</span>
datos_unidos <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">merge</span>(x <span style="color:#f92672">=</span> datos, <span style="color:#75715e">#Unimos el dataframe datos</span>
      y <span style="color:#f92672">=</span> esi2020_m, <span style="color:#75715e">#con el dataframe esi2020_m</span>
      by <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;sexo&#34;</span>, <span style="color:#e6db74">&#34;ing_tot&#34;</span>)) <span style="color:#75715e">#a partir de las columnas &#34;sexo&#34; e &#34;ing_tot&#34;</span>
<span style="color:#a6e22e">head</span>(datos_unidos)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">##     sexo ing_tot        sector prevision salud contrato_dur        id efectivas
## 1 Hombre       0 Sector formal        Si    Si   Indefinido 346362449        21
## 2 Hombre       0 Sector formal        Si    Si   Indefinido 346362449        40
## 3 Hombre       0 Sector formal        Si    Si   Indefinido 346362449         0
## 4 Hombre       0 Sector formal        Si    Si   Indefinido 346362449        45
## 5 Hombre       0 Sector formal        Si    Si   Indefinido 346362449        45
## 6 Hombre       0 Sector formal        Si    Si   Indefinido 346362449        45
</code></pre></div><p>Podemos ver que ahora el tabulado <code>datos</code> tiene 7 columnas el lugar de 6, pues se incorporó la columna <code>efectivas</code>, que estaba presente en <code>esi2020_m</code>, pero no en <code>datos</code>.</p>
<h3 id="b-bind_cols">b) <code>bind_cols()</code></h3>
<p>Otra cosa que podemos hacer es, simplemente, pegar una columna de un dataframe a otro. Para ello recurrimos a la función <code>bind_cols()</code> de <code>dplyr</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">a <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(datos, <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">5</span>) <span style="color:#75715e"># Seleccionamos las primeras cinco columnas de datos</span>
b <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(datos, <span style="color:#ae81ff">3</span><span style="color:#f92672">:</span><span style="color:#ae81ff">7</span>) <span style="color:#75715e"># Seleccionamos las últimas cinco columnas de datos</span>
col_un <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">bind_cols</span>(a, b) <span style="color:#75715e">#Unimos ambos dataframes a partir de sus columnas</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## New names:
## * prevision -&gt; prevision...3
## * salud -&gt; salud...4
## * contrato_dur -&gt; contrato_dur...5
## * prevision -&gt; prevision...6
## * salud -&gt; salud...7
## * ...
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">head</span>(col_un)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## # A tibble: 6 x 10
## # Rowwise: 
##   sector  sexo  prevision...3 salud...4 contrato_dur...5 prevision...6 salud...7
##   &lt;fct&gt;   &lt;fct&gt; &lt;fct&gt;         &lt;fct&gt;     &lt;fct&gt;            &lt;fct&gt;         &lt;fct&gt;    
## 1 Sector~ Mujer Si            Si        Indefinido       Si            Si       
## 2 Sector~ Mujer Si            Si        Definido         Si            Si       
## 3 Sector~ Mujer Si            Si        Indefinido       Si            Si       
## 4 Hogare~ Mujer No            No        Indefinido       No            No       
## 5 Sector~ Homb~ Si            Si        Indefinido       Si            Si       
## 6 Sector~ Homb~ Si            Si        Indefinido       Si            Si       
## # ... with 3 more variables: contrato_dur...8 &lt;fct&gt;, id &lt;dbl&gt;, ing_tot &lt;dbl&gt;
</code></pre></div><p>Vemos que simplemente pegó  <code>a</code> y <code>b</code>. Eso implica que tenemos columnas repetidas. Cuando estemos seguras/os de que hay columnas repetidas entre dos dataframes que queramos unir, emplearemos <code>merge()</code> mientras que, si estos no comparten ninguna columna, recurrimos a <code>bing_cols()</code></p>
<h3 id="c-bind_rows">c) <code>bind_rows()</code></h3>
<p>También podemos unir dos dataframes a partir de sus filas, con la función <code>bind_rows()</code> de <code>dplyr</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">a <span style="color:#f92672">&lt;-</span> a[1<span style="color:#f92672">:</span><span style="color:#ae81ff">10000</span>,] <span style="color:#75715e"># Seleccionamos las primeras 10.000 filas de a</span>
b <span style="color:#f92672">&lt;-</span> b[10001<span style="color:#f92672">:</span><span style="color:#ae81ff">18985</span>,] <span style="color:#75715e"># Seleccionamos las últimas 8.985 filas de b</span>
row_un <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">bind_rows</span>(a, b)
<span style="color:#a6e22e">head</span>(row_un)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">## # A tibble: 6 x 7
## # Rowwise: 
##   sector                   sexo   prevision salud contrato_dur    id ing_tot
##   &lt;fct&gt;                    &lt;fct&gt;  &lt;fct&gt;     &lt;fct&gt; &lt;fct&gt;        &lt;dbl&gt;   &lt;dbl&gt;
## 1 Sector formal            Mujer  Si        Si    Indefinido      NA      NA
## 2 Sector formal            Mujer  Si        Si    Definido        NA      NA
## 3 Sector formal            Mujer  Si        Si    Indefinido      NA      NA
## 4 Hogares como empleadores Mujer  No        No    Indefinido      NA      NA
## 5 Sector formal            Hombre Si        Si    Indefinido      NA      NA
## 6 Sector formal            Hombre Si        Si    Indefinido      NA      NA
</code></pre></div><p><code>bind_rows()</code> nos permite pegar filas, independientemente si ambos dataframes comparten las mismas columnas. En caso de que ambos dataframes no compartan alguna columna, esta función rellenará con valores nulos (<code>NA</code>)</p>
<h1 id="resumen">Resumen</h1>
<p>En este práctico aprendimos a</p>
<ol>
<li>Agrupar datos por filas y columnas.</li>
<li>Manipular datos (tidydata), transformando la estructura de estos a una ancha o larga.</li>
<li>Separar y unir caracteres de una columna.</li>
<li>Unir datos, a partir de filas y columnas.</li>
</ol>
<h1 id="reporte-de-progreso">Reporte de progreso</h1>
<p>¡No olviden llenar el <a href="https://learn-r.formr.org" target="_blank" rel="noopener">reporte de progreso</a>! En tu correo electrónico está disponible el código mediante al cuál debes acceder para actualizar tu estado de avance del curso.</p>

                    </div>

                    



                    
                    <div class="article-widget">
                        
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/example/02-practico/" rel="next">RStudio, tidyverse y RMarkdown</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/example/08-practico/" rel="prev">Regresiones lineales, predictores categóricos y representación gráfica</a>
  </div>
  
</div>

                    </div>
                    
                </div>

                <div class="body-footer">
                    <p>Last updated on August 13, 2021</p>

                    





                    



                </div>

            </article>

            <footer>
    <hr>

    <div class="row course-info">
        <div class="col-md-7">
            <p>
                <strong>2255: Análisis Estadístico en R (II° Semestre- 2021)</strong><br>

                <a href="https://www.uahurtado.cl/" target="_blank" rel="noopener">Universidad Alberto Hurtado</a> &emsp;&emsp;
                <a href="http://sociologia.uahurtado.cl/" target="_blank" rel="noopener">Departamento de Sociología</a>
            </p>

            <p>
                <a href="https://valentinaandrade.netlify.app/" target="_blank" rel="noopener"><i class="fas fa-user"></i>
                    Valentina Andrade</a> &emsp;&emsp;
                <a href="mailto:valentinaandrade@uchile.cl"><i class="fas fa-envelope"></i>
                    valentinaandrade@uchile.cl</a>
            </p>

            <p>
                <i class="far fa-calendar-alt"></i> Clases: Lunes 16.30-17.40 &emsp;&emsp;
                <i class="fas fa-pencil-alt"></i> Práctico: Lunes 18.00-19.20 
                <br><i class="fas fa-university"></i> Online, en link de Zoom
            </p>
        </div>

        <div class="col-md-5 credits">
            <p>All content licensed under a <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="noopener">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.</p>
            
            <p>Content <i class="fab fa-creative-commons"></i> 2021. Web developed by Andrew Heiss and custom by <a href="https://valentinaandrade.netlify.app/" target="_blank" rel="noopener">Valentina Andrade</a></p>
        
            <p>This site created with the <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> in <a href="https://bookdown.org/yihui/blogdown/" target="_blank" rel="noopener">blogdown</a> and <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a>. </p>
            
            <p><a href="https://github.com/valentinaandrade" target="_blank" rel="noopener"><i class="fab fa-github"></i> View the source at GitHub.</a></p>
        </div>
    </div>
</footer>


        </main>
    </div>
</div>

        

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      

      

    

    
    
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    

    
    

    
    
    
    

    
    <script src="/js/bootstrap.bundle.min.8b7df62fd2da18ce73e29c13cc0a6198.js"></script>

    
    

    
    
    
    
    
    
    
    
    
    <script src="/en/js/wowchemy.min.c6ceb5c48772e46156651a48070d6139.js"></script>

    

<script src="/js/math-code.js"></script>


    
    

    
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>

</html>
